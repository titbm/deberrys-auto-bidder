# Auction Auto Bidder - Chrome Extension

## Описание
Расширение Chrome для автоматических ставок на аукционе deberrys.xyz

## Функционал
- Автоматическое размещение ставок с увеличением (текущая+1, текущая+2, текущая+3...)
- Ожидание полной загрузки страницы перед стартом
- Проверка валидности данных (блокировка при "?" в балансе или "Encrypted" в ставке)
- Проверка баланса перед каждой ставкой
- Автоматическая остановка при недостатке монет
- Повтор при ошибках с паузой 3 секунды
- Кнопка запуска/остановки в правом нижнем углу
- Статус-бокс с последними 5 действиями и временем
- Shadow DOM для изоляции от стилей сайта

## Структура проекта
```
auction-auto-bidder/
├── manifest.json       # Манифест расширения Chrome
├── content.js          # Основная логика автоставок
├── styles.css          # Стили для кнопки управления
├── README.md           # Документация
└── DEVELOPMENT.md      # Контекст разработки
```

## Установка

### 1. Подготовка файлов
Все файлы уже созданы в текущей директории.

### 2. Загрузка в Chrome

1. Откройте Chrome и перейдите на `chrome://extensions/`
2. Включите "Режим разработчика" (Developer mode) в правом верхнем углу
3. Нажмите "Загрузить распакованное расширение" (Load unpacked)
4. Выберите папку с файлами расширения
5. Расширение установлено!

### 3. Использование

1. Откройте страницу аукциона: https://deberrys.xyz/auctions/*
2. Дождитесь загрузки данных (баланс и текущая ставка)
3. В правом нижнем углу появится кнопка "Запустить автоставки"
4. Над кнопкой будет статус-бокс с информацией о балансе и текущей ставке
5. Нажмите кнопку для запуска
6. Расширение будет автоматически делать ставки: текущая+1, текущая+2, текущая+3...
7. Для остановки нажмите кнопку снова

**Важно:** Если при загрузке страницы баланс показывает "?" или текущая ставка показывает "Encrypted" - расширение покажет ошибку и не позволит запустить автоставки. Обновите страницу.

## Как это работает

### Алгоритм работы:

**Инициализация:**
1. **Ожидание загрузки** - ждет до 30 секунд, пока загрузятся баланс и текущая ставка
2. **Проверка валидности** - если баланс = "?" или ставка = "Encrypted", показывает ошибку и блокирует запуск
3. **Готовность** - кнопка становится активной, показывается статус с балансом и текущей ставкой

**Цикл ставок:**
1. **Проверка баланса** - читает количество монет из блока BalanceDisplay
2. **Проверка текущей ставки** - читает текущую ставку на аукционе
3. **Открытие модального окна** - кликает на кнопку "Place a Bid", ждет 1000мс
4. **Ввод ставки** - вводит значение ставки в поле input, ждет 500мс
5. **Отправка** - кликает на кнопку submit
6. **Ожидание результата** - ждет до 10 минут появления сообщения об успехе или ошибки
7. **Обработка результата:**
   - **Успех:** закрывает окно, увеличивает ставку на 1, ждет 30 секунд, переходит к следующей
   - **Ошибка:** показывает ошибку 3 секунды, закрывает окно, ждет 3 секунды, повторяет с той же ставкой
8. **Повтор** - цикл продолжается пока хватает монет и не нажата кнопка остановки

**Обработка ошибок:**
- "Relayer didn't response correctly" - повтор через 3 сек
- "No Berries available" - остановка
- "?" в балансе во время работы - остановка с предупреждением
- "Encrypted" в ставке во время работы - остановка с предупреждением

### Селекторы (используемые в коде):

```javascript
// Баланс монет
'[data-sentry-component="BalanceDisplay"] span:first-child'

// Текущая ставка на аукционе
'span.text-2xl.text-white.font-medium' (рядом с [data-sentry-component="Berry"])

// Кнопка открытия модального окна
'button[data-sentry-source-file="place-a-bid.tsx"]'

// Поле ввода ставки
'[role="dialog"] input[type="text"]'

// Кнопка отправки ставки
'[role="dialog"] button[type="submit"]'

// Сообщение об успехе
'[role="dialog"] p' (содержит текст "successfully bid")

// Сообщение об ошибке
'[role="dialog"] .text-red-500'

// Закрытие модального окна
ESC key (самый надежный способ)
```

## Логирование и статус
- Все действия логируются в консоль браузера (F12 → Console) с префиксом `[AutoBidder]`
- Статус-бокс над кнопкой показывает последние 5 действий с временем
- Зеленый цвет - успешные действия
- Красный цвет - ошибки
- Сообщения обрезаются до 80 символов для читаемости

## Безопасность
- Расширение работает только на домене deberrys.xyz
- Не собирает и не отправляет данные
- Весь код выполняется локально

## Возможные проблемы

### Кнопка показывает "Ошибка загрузки данных"
- Баланс показывает "?" или текущая ставка показывает "Encrypted"
- **Решение:** Обновите страницу и подождите полной загрузки данных

### Кнопка не появляется
1. Обновите страницу
2. Проверьте, что расширение включено в chrome://extensions/
3. Проверьте консоль на наличие ошибок
4. Убедитесь, что вы на странице аукциона (https://deberrys.xyz/auctions/*)

### Кнопка не видна / под элементами сайта
- Расширение использует Shadow DOM для изоляции стилей
- Если проблема сохраняется, проверьте консоль на ошибки

### Ставки не размещаются
1. Проверьте баланс монет (должно быть достаточно)
2. Убедитесь, что модальное окно открывается корректно
3. Проверьте логи в консоли для деталей
4. Проверьте статус-бокс над кнопкой для информации об ошибках

### Автоставки остановились
- Проверьте статус-бокс и консоль для причины остановки
- Возможные причины: недостаток монет, появление "?" или "Encrypted", ошибки сервера
- **Решение:** Проверьте баланс, обновите страницу если нужно, запустите снова

## Отладка
Для отладки откройте консоль разработчика (F12) и следите за сообщениями с префиксом `[AutoBidder]`

### Проверка селекторов в консоли:
```javascript
// Баланс
document.querySelector('[data-sentry-component="BalanceDisplay"] span:first-child')?.textContent

// Текущая ставка
Array.from(document.querySelectorAll('span.text-2xl.text-white.font-medium'))
  .find(el => el.closest('div')?.querySelector('[data-sentry-component="Berry"]'))?.textContent

// Кнопка открытия модального окна
document.querySelector('button[data-sentry-source-file="place-a-bid.tsx"]')

// Поле ввода (после открытия модального окна)
document.querySelector('[role="dialog"] input[type="text"]')
```

## Обновление
При изменении кода:
1. Сохраните файлы
2. Перейдите в chrome://extensions/
3. Нажмите кнопку обновления расширения (круговая стрелка)
4. Обновите страницу аукциона
